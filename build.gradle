apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'application'
apply plugin: 'maven'
apply plugin: 'maven-publish'

buildscript {
	repositories {
		maven {
			url "https://plugins.gradle.org/m2/"
		}
		jcenter()
	}
}

sourceCompatibility = 1.8
version = '0.1.0'

group = 'net.fabricmc'
archivesBaseName = project.name.toLowerCase()
mainClassName = "net.fabricmc.blendingjar.Main"

repositories {
	mavenCentral()
}

dependencies {
	compile 'commons-io:commons-io:2.5'
	compile 'org.ow2.asm:asm:5.1'
	compile 'org.ow2.asm:asm-tree:5.1'
}

jar {
	manifest {
		attributes	'Implementation-Title': 'BlendingJar',
				'Implementation-Version': version,
				'Main-Class': mainClassName
	}
	from {
		configurations.compile.collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
}

uploadArchives {
    repositories {
        mavenDeployer {
            if (project.hasProperty('mavenPass')) {
                repository(url: 'http://mavenupload.modmuss50.me/') {
                    authentication(userName: 'buildslave', password: project.getProperty('mavenPass'))
                }
            } else {
                repository(url: 'file:///var/www/maven/')
            }

            pom {
                artifactId = project.archivesBaseName

                project {
                    name = project.name
                    description = project.description
                    packaging = 'jar'
                    url = project.url

                    scm {
                        url = 'https://github.com/FabricMC/blending-jar'
                        connection = 'scm:git:git@github.com:FabricMC/blending-jar.git'
                        developerConnection = 'scm:git:git@github.com:FabricMC/blending-jar.git'
                    }

                    issueManagement {
                        system = 'GitHub'
                        url = 'https://github.com/FabricMC/blending-jar/issues'
                    }

                    licenses {
                        license {
                            name = 'Apache 2 License'
                            url = 'https://github.com/FabricMC/blending-jar/blob/master/LICENSE'
                            distribution = 'repo'
                        }
                    }

                    developers {
                        developer {
                            id = 'asiekierka'
                            name = 'asiekierka'
                            roles { role 'developer' }
                        }
                    }
                }
            }
        }
    }
}

