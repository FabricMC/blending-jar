apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'application'
apply plugin: 'maven'
apply plugin: 'maven-publish'

buildscript {
	repositories {
		maven {
			url "https://plugins.gradle.org/m2/"
		}
		jcenter()
	}
}

sourceCompatibility = 1.8

def ENV = System.getenv()
if (ENV.BUILD_NUMBER) {
    version = version + "." + "${System.getenv().BUILD_NUMBER}"
}

group = 'net.fabricmc'
archivesBaseName = project.name.toLowerCase()
mainClassName = "net.fabricmc.weave.Main"

repositories {
	mavenCentral()
	maven {
		name = 'fabric'
		url = 'http://maven.fabricmc.net/'
	}
	maven {
		name "RX14 Repository"
		url 'http://mvn.rx14.co.uk/local/'
	}
}

dependencies {
	compile 'com.google.guava:guava:19.+'
	compile 'org.ow2.asm:asm:5.1'
	compile 'org.ow2.asm:asm-commons:5.1'
	compile 'org.ow2.asm:asm-tree:5.1'

	compile('net.fabricmc:enigma:0.11.0.53:lib') {
		exclude module: 'procyon-compilertools'
	}
	compile 'org.javassist:javassist:3.+'
}

apply from: 'https://github.com/FabricMC/fabric-docs/raw/master/gradle/maven.gradle'
apply from: 'https://github.com/FabricMC/fabric-docs/raw/master/gradle/license.gradle'

jar {
	manifest {
		attributes	'Implementation-Title': 'Weave',
				'Implementation-Version': version,
				'Main-Class': mainClassName
	}
	from {
		configurations.compile.collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
}
